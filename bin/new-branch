#!/bin/sh
#
# Creates a new git branch, and appends the current branch's name
# to its dependencies
#
# SPDX-License-Identifier: Apache-2.0
# Copyright 2020 Christian Kohlschuetter -- see NOTICE file

cd "$(dirname $0)/.."

set -e
currentBranch=$(git branch --show-current)
if [ -z "$currentBranch" ]; then
  echo "Currently not on a branch" >&2
  exit 1
fi

git checkout -b "$1"

mkdir -p ./dependencies
escapedBranchName=${currentBranch//// }
depFile="./dependencies/$escapedBranchName"
touch "$depFile"
git add "$depFile"
git commit -m "New branch based on: $currentBranch"
